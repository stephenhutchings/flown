(()=>{var w=t=>[...document.querySelectorAll(t)],L=t=>{let a=document.querySelector(t.currentTarget.hash);a&&t.currentTarget.dataset.noscroll===void 0&&t.currentTarget.hash&&t.currentTarget.pathname===window.location.pathname&&!t.metaKey&&(t.preventDefault(),a.scrollIntoView({behavior:"smooth"}))},E=t=>new Promise(a=>{let i=document.createElement("img");i.onload=()=>a(i),i.src=t}),p=(t,a,i,v,u)=>{let e=a.width,r=a.height,c=t.canvas.width,s=t.canvas.height,o=c,n=s;if(i!=="stretch"){let h=1;i==="contain"&&(h=Math.min(c/e,s/r)),i==="cover"&&(h=Math.max(c/e,s/r)),i==="balance"&&(h=(c/e+s/r)*.5),o=Math.floor(e*h),n=Math.floor(r*h)}let l=v==="hoist"?0:(c-o)/2,d=(s-n)/2;t.drawImage(a,l,d,o,n),!u&&(o<c&&(t.drawImage(a,0,0,1,r,0,d,l,n),t.drawImage(a,e-1,0,1,r,l+o,d,c-(o+l),n)),n<s&&(t.drawImage(a,0,0,e,1,l,0,o,d),t.drawImage(a,0,r-1,e,1,l,n+d,o,d)))};w("a[href*='#']").forEach(t=>t.addEventListener("click",L));w("[data-component='replace']").forEach(t=>t.addEventListener("click",()=>{let a=t.dataset.replace,i=t.parentNode;t.remove(),i.innerHTML=a}));w("[data-component='image-diff'").forEach(async t=>{let a=t.querySelector("canvas"),i=t.querySelector(".status-count"),v=await E(t.dataset.imageA),u=await E(t.dataset.imageB),e=a.getContext("2d",{willReadFrequently:!0});a.width*=window.devicePixelRatio,a.height*=window.devicePixelRatio;let{width:r,height:c}=a,s=(o,n)=>{let l=t.resize?t.resize.value:"stretch",d=t.align?t.align.value:"center",h=1.5;if(e.clearRect(0,0,r,c),e.globalCompositeOperation="source-over",p(e,v,l,d,o||n),o||n){e.filter="none";let f=a.width/a.offsetWidth,g=3*f,m=100*f;o*=f,n*=f,e.save(),e.beginPath(),e.moveTo(o+m,n),e.arc(o,n-.001,m,0,Math.PI*2),e.closePath(),e.clip(),p(e,u,l,d),e.restore(),e.beginPath(),e.moveTo(o+m-g/2,n),e.arc(o,n-.001,m-g/2,0,Math.PI*2),e.closePath(),e.strokeStyle="#aaa3",e.lineWidth=g,e.stroke();return}e.filter=`contrast(${h})`,e.globalCompositeOperation="difference",p(e,u,l,d);let{data:b}=e.getImageData(0,0,r,c);e.fillStyle="white",e.globalCompositeOperation="color",e.fillRect(0,0,r,c),e.globalCompositeOperation="difference",e.fillRect(0,0,r,c),e.fillStyle="#121e25",e.globalCompositeOperation="lighten",e.fillRect(0,0,r,c);let I=b.reduce((f,g,m)=>f+(m%4===3?0:g/255))/(b.length*.75);i.innerHTML=(I*100).toFixed(1)+"%"};t.addEventListener("submit",o=>{o.preventDefault()}),t.addEventListener("input",o=>{s()}),a.addEventListener("touchmove",o=>{o.preventDefault()}),a.addEventListener("pointermove",o=>{s(o.offsetX,o.offsetY)}),a.addEventListener("pointerleave",()=>{s()}),s()});})();
