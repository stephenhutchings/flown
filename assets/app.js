(()=>{var I=t=>[...document.querySelectorAll(t)],P=t=>{let o=document.querySelector(t.currentTarget.hash);o&&t.currentTarget.dataset.noscroll===void 0&&t.currentTarget.hash&&t.currentTarget.pathname===window.location.pathname&&!t.metaKey&&(t.preventDefault(),o.scrollIntoView({behavior:"smooth"}))},b=t=>new Promise(o=>{let s=document.createElement("img");s.onload=()=>o(s),s.src=t}),w=(t,o,s,v,u)=>{let e=o.width,r=o.height,i=t.canvas.width,c=t.canvas.height,a=i,n=c;if(s!=="stretch"){let h=1;s==="contain"&&(h=Math.min(i/e,c/r)),s==="cover"&&(h=Math.max(i/e,c/r)),s==="balance"&&(h=(i/e+c/r)*.5),a=Math.floor(e*h),n=Math.floor(r*h)}let l=v==="hoist"?0:(i-a)/2,d=(c-n)/2;t.drawImage(o,l,d,a,n),!u&&(a<i&&(t.drawImage(o,0,0,1,r,0,d,l,n),t.drawImage(o,e-1,0,1,r,l+a,d,i-(a+l),n)),n<c&&(t.drawImage(o,0,0,e,1,l,0,a,d),t.drawImage(o,0,r-1,e,1,l,n+d,a,d)))};I("a[href*='#']").forEach(t=>t.addEventListener("click",P));I("[data-component='image-diff'").forEach(async t=>{let o=t.querySelector("canvas"),s=t.querySelector(".status-count"),v=await b(t.dataset.imageA),u=await b(t.dataset.imageB),e=o.getContext("2d",{willReadFrequently:!0});o.width*=window.devicePixelRatio,o.height*=window.devicePixelRatio;let{width:r,height:i}=o,c=(a,n)=>{let l=t.resize?t.resize.value:"stretch",d=t.align?t.align.value:"center",h=1.5;if(e.clearRect(0,0,r,i),e.globalCompositeOperation="source-over",w(e,v,l,d,a||n),a||n){e.filter="none";let f=o.width/o.offsetWidth,m=3*f,g=100*f;a*=f,n*=f,e.save(),e.beginPath(),e.moveTo(a+g,n),e.arc(a,n-.001,g,0,Math.PI*2),e.closePath(),e.clip(),w(e,u,l,d),e.restore(),e.beginPath(),e.moveTo(a+g-m/2,n),e.arc(a,n-.001,g-m/2,0,Math.PI*2),e.closePath(),e.strokeStyle="#aaa3",e.lineWidth=m,e.stroke();return}e.filter=`contrast(${h})`,e.globalCompositeOperation="difference",w(e,u,l,d);let{data:p}=e.getImageData(0,0,r,i);e.fillStyle="white",e.globalCompositeOperation="color",e.fillRect(0,0,r,i),e.globalCompositeOperation="difference",e.fillRect(0,0,r,i),e.fillStyle="#121e25",e.globalCompositeOperation="lighten",e.fillRect(0,0,r,i);let E=p.reduce((f,m,g)=>f+(g%4===3?0:m/255))/(p.length*.75);s.innerHTML=(E*100).toFixed(1)+"%"};t.addEventListener("submit",a=>{a.preventDefault()}),t.addEventListener("input",a=>{c()}),o.addEventListener("touchmove",a=>{a.preventDefault()}),o.addEventListener("pointermove",a=>{c(a.offsetX,a.offsetY)}),o.addEventListener("pointerleave",()=>{c()}),c()});})();
